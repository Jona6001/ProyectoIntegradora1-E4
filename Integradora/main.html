
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menú principal</title>
    <link rel="stylesheet" href="../css/stylesmain.css">
    <script src="../scripts/script.js" defer></script>
    <script src="../scripts/index.js"></script>
</head>
<body>
<header>
    <div class="logo-title">
        <img src="../img/logo.jpg" alt="Logo Agenda Dental" class="logo">
        <div class="welcome-message">
            <h1>Bienvenido a tu Consultorio Dental</h1>
            <p id="bienvenido"></p>
            <p id="fecha"></p>
        </div>
    </div>
    <button type="button" id="cerrar" onclick="cerrarSesion()">Cerrar Sesión</button>
</header>



        <!-- Menú horizontal con accesos desplegables -->
        <nav id="menu-gestores">
            <ul>
                <li><a href="#">Gestión de Citas</a>
                    <ul>
                        <li><a href="../screens/Cita_Nueva.html">Agregar Cita</a></li>
                        <li><a href="../screens/Citas_Registradas.html">Ver Citas Registradas</a></li>

                    </ul>
                </li>
                <li><a href="#">Gestión de Clientes</a>
                    <ul>
                        <li><a href="Cliente_Nuevo.html">Agregar Cliente</a></li>
                        <li><a href="Clientes_Registrados.html">Ver Clientes Registrados</a></li>
                
                    </ul>
                </li>
                <li><a href="#">Gestión de Servicios</a>
                    <ul>
                        <li><a href="Servicio_Nuevo.html">Agregar Servicio</a></li>
                        <li><a href="Servicios_Registrados.html">Ver Servicios</a></li>

                    </ul>
                </li>
                
                <li><a href="#">Gestión de Empleados</a>
                    <ul>
                        <li><a href="Empleado_Nuevo.html">Agregar Empleado</a></li>
                        <li><a href="Empleados_Registrados.html">Ver Emplaedos Registrados</a></li>

                    </ul>
                </li>
            </ul>
        </nav>

    <table border="1" id="tablaCitas"> <h1 id="titulotabla">Citas para el día de hoy:</h1>
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Fecha</th>
                <th>Hora</th>
                <th>Servicio</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody id="citasBodyMain"></tbody>
    </table>
    <div id="paginationMain"></div>
    


    <div class="container">
        <section id="gestor-citas">
            <h2>Gestionar las Citas</h2>
            <p>Administra tus citas existentes de manera sencilla.</p>
            <a href="Citas_Registradas.html" class="button-image">
                <img src="../img/modificarcitas.png" alt="Administrar Citas">
                <p>Ir al gestor de Citas</p>
            </a>
        </section>

        <section id="gestor-clientes">
            <h2>Gestionar los clientes</h2>
            <p>Administra a tus clientes existentes eficientes.</p>
            <a href="Clientes_Registrados.html" class="button-image">
                <img src="../img/persona.jpg" alt="Administrar Clientes">
                <p>Ir al gestor de clientes</p>
            </a>
        </section>

        <section id="gestor-servicios">
            <h2>Gestionar los servicios</h2>
            <p>Administra los servicios que se realizan.</p>
            <a href="Servicios_Registrados.html" class="button-image">
                <img src="../img/servicios.jpg" alt="Administrar Servicios">
                <p>Ir al gestor de Servicios</p>
            </a>
        </section>

        <!-- Nueva sección para gestionar usuarios -->
        <section id="gestor-empleado">
            <h2>Gestionar los empleados</h2>
            <p>Edita y administra la información de los empleados.</p>
            <a href="Empleados_Registados.html" class="button-image">
                <img src="../img/agregarcliente.jpg" alt="Administrar Empleados">
                <p>Ir al gestor de Empleados</p>
            </a>
        </section>
    </div>
    <script>
        // Verificar si la sesión está activa
        fetch('/isAuthenticated', { method: 'GET' })
            .then(response => {
                if (!response.ok) {
                    // Si no está autenticado, redirigir al inicio de sesión
                    window.location.href = '/';
                }
            });
    document.addEventListener('DOMContentLoaded', () => {
        fetch('/verificar_sesion', { method: 'GET', credentials: 'same-origin' })
            .then(response => {
                if (!response.ok) {
                    window.location.href = '/'; // Redirige al inicio si no hay sesión
                }
            })
            .catch(error => {
                console.error('Error verificando la sesión:', error);
                window.location.href = '/';
            });
         });
    
  
   // Verificar el rol del usuario para mostrar la sección de gestión de empleados
    fetch('/api/session')
        .then(response => response.json())
        .then(data => {
            console.log('Datos de sesión en el cliente:', data); // Debugging: verifica los datos en el cliente
            if (data.loggedIn) {
                // Mostrar "gestor-empleado" solo si el rol es "admin"
                if (data.rol === 'admin') {
                    document.getElementById('gestor-empleado').style.display = 'block';
                } else {
                    document.getElementById('gestor-empleado').style.display = 'none';
                }
            }
        })
        .catch(error => console.error('Error al obtener la sesión:', error));

    </script>
    
    
</body>
</html>
